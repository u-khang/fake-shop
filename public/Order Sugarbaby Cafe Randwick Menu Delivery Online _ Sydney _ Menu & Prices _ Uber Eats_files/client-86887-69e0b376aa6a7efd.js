(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[86887,16192,37394,192,87639,87429,47605,70010],{7858:(e,t,n)=>{var r="__lodash_hash_undefined__",s="[object Function]",i="[object GeneratorFunction]",a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/,c=/^\./,l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,u=/\\(\\)?/g,d=/^\[object .+?Constructor\]$/,h="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,p="object"==typeof self&&self&&self.Object===Object&&self,g=h||p||Function("return this")();var f=Array.prototype,m=Function.prototype,_=Object.prototype,y=g["__core-js_shared__"],v=function(){var e=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),b=m.toString,S=_.hasOwnProperty,x=_.toString,C=RegExp("^"+b.call(S).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),k=g.Symbol,Z=f.splice,E=z(g,"Map"),w=z(Object,"create"),O=k?k.prototype:void 0,$=O?O.toString:void 0;function D(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function H(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function M(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function T(e,t){for(var n=e.length;n--;)if(q(e[n][0],t))return n;return-1}function P(e,t){for(var n=0,r=(t=function(e,t){if(N(e))return!1;var n=typeof e;if("number"==n||"symbol"==n||"boolean"==n||null==e||j(e))return!0;return o.test(e)||!a.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:function(e){return N(e)?e:I(e)}(t)).length;null!=e&&n<r;)e=e[B(t[n++])];return n&&n==r?e:void 0}function A(e){return!(!F(e)||function(e){return!!v&&v in e}(e))&&(function(e){var t=F(e)?x.call(e):"";return t==s||t==i}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?C:d).test(function(e){if(null!=e){try{return b.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function R(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function z(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return A(n)?n:void 0}D.prototype.clear=function(){this.__data__=w?w(null):{}},D.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},D.prototype.get=function(e){var t=this.__data__;if(w){var n=t[e];return n===r?void 0:n}return S.call(t,e)?t[e]:void 0},D.prototype.has=function(e){var t=this.__data__;return w?void 0!==t[e]:S.call(t,e)},D.prototype.set=function(e,t){return this.__data__[e]=w&&void 0===t?r:t,this},H.prototype.clear=function(){this.__data__=[]},H.prototype.delete=function(e){var t=this.__data__,n=T(t,e);return!(n<0)&&(n==t.length-1?t.pop():Z.call(t,n,1),!0)},H.prototype.get=function(e){var t=this.__data__,n=T(t,e);return n<0?void 0:t[n][1]},H.prototype.has=function(e){return T(this.__data__,e)>-1},H.prototype.set=function(e,t){var n=this.__data__,r=T(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},M.prototype.clear=function(){this.__data__={hash:new D,map:new(E||H),string:new D}},M.prototype.delete=function(e){return R(this,e).delete(e)},M.prototype.get=function(e){return R(this,e).get(e)},M.prototype.has=function(e){return R(this,e).has(e)},M.prototype.set=function(e,t){return R(this,e).set(e,t),this};var I=L((function(e){e=function(e){return null==e?"":function(e){if("string"==typeof e)return e;if(j(e))return $?$.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}(e);var t=[];return c.test(e)&&t.push(""),e.replace(l,(function(e,n,r,s){t.push(r?s.replace(u,"$1"):n||e)})),t}));function B(e){if("string"==typeof e||j(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function L(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var a=e.apply(this,r);return n.cache=i.set(s,a),a};return n.cache=new(L.Cache||M),n}function q(e,t){return e===t||e!=e&&t!=t}L.Cache=M;var N=Array.isArray;function F(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function j(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==x.call(e)}e.exports=function(e,t,n){var r=null==e?void 0:P(e,t);return void 0===r?n:r}},92067:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(91931),s=n(33497);const i=(0,r.zo)("button",(e=>{let{$theme:t,radius:n}=e;return{...(0,s.Z)({$theme:t,radius:n}),textDecoration:"none",":active":{background:t.colors.backgroundSecondary}}}))},3007:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(62149),s=n(14487),i=n(47986),a=n(1795),o=n(33990);const c=()=>{const e=(0,r.TH)();return(0,o.tZ)(s.ZP,{backLocation:(0,i.N0q)(e),children:(0,o.tZ)(a.Z,{})})}},14487:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>x,a7:()=>b,cN:()=>S});var r=n(36151),s=n(91931),i=n(4927),a=n(74419),o=n(94579),c=n(62149),l=n(95747),u=n(47986),d=n(6966),h=n(15070),p=n(26034),g=n(75907),f=n(39141),m=n(33990);const _=(0,s.zo)("div",(e=>{let{$theme:t,$overlay:n,$takeOverModal:r}=e;return{display:"flex",flexDirection:"column",flex:1,background:t.colors.backgroundPrimary,maxWidth:"100%",height:"100%",position:"relative",zIndex:r?o.I_.base:o.I_.modal,...n?{position:"absolute",top:0,width:"100%"}:{}}})),y=(0,s.zo)("div",(e=>({position:e.$isStuck?"sticky":"relative",zIndex:o.I_.modal,top:0}))),v=(0,s.zo)("div",(e=>({padding:e.$removeTopPadding?"12px 16px 0 16px":"64px 16px 0 16px",height:"100%",boxSizing:"border-box"}))),b=(0,s.Le)(v,(e=>function(t){const n=(0,h.v)((e=>{let{embeddedFeatures:t}=e;return t})).xlbHeaderBridge,{children:r,...s}=t;return(0,m.tZ)(e,{$removeTopPadding:n,...s,children:r})})),S=i.Z,x=e=>{const t=(0,c.TH)(),n=(0,l.Z)(),s=r.useContext(f.w),{backLocation:i=(0,u.W57)(t),hasBackButton:o,hasCloseButton:v=!0,inverseColor:b=!1,isHeaderStatic:S,stickyBanner:x,onClose:C=(()=>n(i)),isTakeOverModal:k,isSecondaryCloseButton:Z=!1}=e,{elementRef:E,isStuck:w}=(0,d.Z)(),O=(0,h.v)((e=>{let{embeddedFeatures:t}=e;return t})).xlbHeaderBridge;return(0,m.BX)(_,{$overlay:e.overlay,$takeOverModal:s?.isTakeOverModal??k,"data-test":e.dataTest??"mobile-dialog",children:[x?(0,m.tZ)(y,{$isStuck:w,children:(0,m.tZ)(x,{})}):null,(0,m.tZ)(g.Z,{children:(0,m.tZ)(p.Z,{})}),(0,m.tZ)(a.Z,{headerRef:E,hasBackButton:o,hasCloseButton:v,onClose:C,isSecondaryCloseButton:Z,hideHeader:!0,inverseColor:b,isStuck:!O&&w,title:e.title,topRightIconButton:e.topRightIconButton,isHeaderStatic:S,hasShadow:e.headerHasShadow}),e.children]})}},42773:(e,t,n)=>{"use strict";n.d(t,{Z:()=>A});var r=n(75514),s=n(36151),i=n(30840),a=n(91631),o=n(79857);const c=e=>{const t=(0,o.Z)(),n=(0,s.useCallback)((t=>{const n=function(e){if(e&&"object"==typeof e&&"string"==typeof e.type){const t=e.payload;return{type:e.type,payload:t&&"object"==typeof t?Object.keys(t).reduce(((e,n)=>(e[n]=t[n],e)),{}):null}}return null}(t?.data),r=t?.origin;return!!n&&e(n,r)}),[e]);(0,s.useEffect)((()=>{if(t&&r.Z)return r.Z.addEventListener("message",n),()=>{r.Z&&r.Z.removeEventListener("message",n)}}),[t,n])};var l=n(79851),u=n(69611),d=n(81149),h=n(42973),p=n(47986),g=n(24316),f=n(67672),m=n(62149),_=n(38777),y=n(60239),v=n(74622),b=n(62459);var S=n(78284),x=n(40832),C=n(72843),k=n(97148),Z=n(33535),E=n(27871),w=n(56962),O=n(87444);const $="BACK_TO_FEED",D="HELP",H="ACCOUNT",M="SHOPPING_CART",T="STORE_OVERFLOW",P="SEARCH",A=()=>{const e=(0,a.k6)(),t=(0,l.Z)(),n=(0,m.TH)(),o=(0,u.Z)(),{totalOrders:A}=(0,g.Z)(),{hydrateDelegatedBooking:R,isDelegatedBooking:z}=(0,_.W)(),I=(0,i.Z)({page:"order"}),B=(0,p.vN_)(n,"storeOverflowActions"),L=(0,p.SCs)(n),{toggleIsOpen:q}=(0,h.qi)(),N=function(e){const t=(0,b.Z)("setLocationDetailsWithAddressV1");return(0,v.useMutation)((e=>t.request("setLocationDetailsWithAddressV1",e)),e)}(),{saveChanges:F}=(0,x.a8)(),j=(0,Z.ZP)(),{dataKey:U}=(0,E.CK)(),V=(0,v.useQueryClient)(),G=(0,p.LcP)(n),[X,Q]=(0,w.Z)("orchid.address",null),K=(0,O.Z)("orchid_omit_city_in_lookup");return c((0,s.useCallback)(((s,i)=>{if(!z||y.fW.find((e=>e.test(i)))){if("CUSTOM_HEADER_ACTION"===s.type){const n=s.payload;if(n?.action===$)e.push(t);else if(n?.action===D)(0,f.Z)(I);else if(n?.action===H)q();else if(n?.action===P)e.push(L);else if(n?.action===M){if(!r.Z)return;A<=1?e.push((0,p.nQQ)(r.Z.location)):(0,p.zrB)(r.Z.location,"multicartMobileSwitcher")?e.replace((0,p.C45)(r.Z.location)):e.push((0,p.vN_)(r.Z.location,"multicartMobileSwitcher"))}else n?.action===T&&e.push(B)}else y.qn.includes(s.type)&&R(s.payload,i);if("USER_TRIGGERED_IMPRESSION"===s.type&&((0,d.be)(),o({source:"user_triggered"})),"SEARCH_RESULTS"===s.type){const t=s.payload?.q;"string"==typeof t&&t.length>0&&e.push((0,p.Xqq)(n,{userQuery:t}))}if("EMBEDDING_APP_ADDRESS_UPDATE"===s.type||"ORCHID_ADDRESS_UPDATE"===s.type){const t=s.payload;t&&N.mutate({latitude:t.coordinates.latitude,longitude:t.coordinates.longitude,address:(0,k.iw)(t,{omitCity:K}),sourceAddress:t},{onSuccess:r=>{j("orchid:bridge_address_update_success"),(0,k.$J)(r)&&Q(t),F((()=>{const t=C.parse(n.search||"");(t[p.FSm.place]||t[p.FSm.latitude]||t[p.FSm.longitude])&&e.replace((0,p.DZj)({location:n,newQueryParams:{place:(0,S.aj)((0,S.VN)(r))}}))}),{overrideLocationDraft:r,overrideDraftInstructions:{...t.apartmentNumber?{aptOrSuite:t.apartmentNumber}:{},...t.instructions?{notes:t.instructions}:{}},skipLocationUpsert:(0,k.$J)(r)}).catch((e=>{j("orchid:bridge_address_update_failure",{error:e})}))},onError:t=>{j("orchid:bridge_address_update_failure",{error:t}),e.replace(G)}})}if("EMBEDDING_APP_NAVIGATION_REQUEST"===s.type){const t=s.payload;t?.url&&t?.method&&e[t.method](t.url)}if("RELOAD_CHECKOUT"===s.type){const t=(0,p.zrB)(n,"orderValidationError");V.invalidateQueries(U),t&&e.replace((0,p.C45)(n))}}}),[e,t,I,L,q,A,B,o,z,R,n,N,F,j,V,U,G,Q,K])),null}},4927:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(91931),s=n(94579),i=n(33990);const a=(0,r.zo)("div",{height:"112px"}),o=(0,r.zo)("div",(e=>{let{$theme:t,$padding:n}=e;return{padding:n,position:"fixed",bottom:0,left:0,right:0,zIndex:s.I_.cover,...t.overlays.floatingButtonGradient}}));function c(e){return(0,i.BX)("div",{children:[(0,i.tZ)(a,{}),(0,i.tZ)(o,{$padding:e.overrides?.padding??s.a9,children:e.children})]})}},87429:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(91931),s=n(36278),i=n(94579),a=n(33990);const o=(0,r.zo)("div",(e=>{let{$reverse:t}=e;return{display:"flex",position:"relative",flexDirection:t?"row-reverse":"row"}})),c=(0,r.zo)("input",(e=>{let{$theme:t,checked:n}=e;return{position:"absolute",opacity:0,pointerEvents:"none",outline:"none",":focus[data-focus-visible-added]+label:before":{...n?{boxShadow:`0 0 0 2px ${t.colors.focus}`}:{border:`solid 3px ${t.colors.borderSelected}`}}}})),l=e=>encodeURIComponent(`\n  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path d="M0 0V20H20V0H0ZM8.5 15.1L2.90002 9.5L5 7.39999L8.40002 10.8L14.8 4.39999L16.9 6.5L8.5 15.1Z" fill="${e}" />\n  </svg>\n  `),u=(0,r.zo)("label",(e=>{let{$checked:t,$disabled:n,$reverse:r,$theme:s}=e;return{...s.typography.LabelMedium,width:"100%",display:"flex",boxSizing:"border-box",alignItems:"center",flexDirection:r?"row-reverse":"row",justifyContent:"space-between",cursor:"pointer",fontSize:"16px",lineHeight:"20px",transition:"background-color 100ms ease 0s",":before":{flex:"none",display:"flex",boxSizing:"border-box",border:n?`solid 3px ${s.colors.disabled}`:`solid 3px ${s.colors.tickBorder}`,...t?{border:"0",backgroundColor:s.colors.tickMarkFill,backgroundImage:`url('data:image/svg+xml,${l(s.colors.tickFillSelected)}');`,backgroundPosition:"center center",backgroundSize:"cover"}:{},content:"''",cursor:"pointer",height:i.sh,width:i.sh,verticalAlign:"middle"}}})),d=e=>(0,a.BX)(o,{$reverse:Boolean(e.reverse),children:[e.startElement,(0,a.tZ)(c,{type:"checkbox",id:e.id,name:e.name,value:e.value,checked:e.isChecked,disabled:Boolean(e.isDisabled),onChange:e.onChange}),(0,a.BX)(u,{htmlFor:e.id,$disabled:Boolean(e.isDisabled),$reverse:e.reverse,$checked:e.isChecked,children:[(0,a.tZ)(s.ZP,{$width:"16px"}),e.children]})]})},56094:(e,t,n)=>{"use strict";n.d(t,{Z:()=>re});var r=n(36151);const s=()=>{},i=e=>!(!e||"object"!=typeof e)&&("function"==typeof e.timing&&"function"==typeof e.increment),a=()=>({increment:s,timing:s}),o=e=>{try{const t=JSON.parse(e);return"object"==typeof t?t:{}}catch(e){return{}}},c=e=>{let t=!1;return(n,r)=>{t||(t=!0,e(n,r))}},l=(e,t)=>{if(e.xhr.readyState===e.xhr.UNSENT||e.xhr.readyState===e.xhr.DONE)return;Date.now()-e.lastResponse>t&&e.xhr.abort(),setTimeout(l,t,e,t)};function u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>e:1===t.length?t[0]:t.reduce(((e,t)=>function(){return e(t(...arguments))}))}const d={ACK:"/events/ack",RECV:"/events/recv"},h={dca1:"dca",phx2:"phx"},p=(e,t,n)=>{switch(n){case"sameorigin":return`/ramen${h[t]}${d[e]||""}`;case"breeze":return`https://ramen${h[t]}.uber.com${d[e]||""}`;case"openid":return`https://ramen${h[t]}.uberinternal.com${d[e]||""}`;default:return`https://cn-${t}.uber.com/ramen${d[e]||""}`}},g={altitude:"x-uber-device-location-altitude",app:"x-uber-client-name",authorization:"Authorization",device:"x-uber-device",deviceId:"x-uber-device-id",deviceIds:"x-uber-device-ids",deviceModel:"x-uber-device-model",deviceOS:"x-uber-device-os",epoch:"x-uber-device-epoch",language:"x-uber-device-language",latitude:"latitude",longitude:"longitude",origin:"x-uber-origin",regionId:"x-uber-region-id",service:"x-uber-push-service",source:"x-uber-source",token:"x-uber-token",uuid:"x-uber-uuid",version:"x-uber-client-version",screenflowVersion:"x-uber-screenflow-client-version",appVariant:"x-uber-app-variant"},f=e=>(e.hasOwnProperty("device")||(e.device="web"),Object.keys(e).map((t=>{const n=g[t],r=e[t];if(n&&r)return[n,e[t]]})).filter(Boolean)),m=(e,t)=>e.slice(-1)===t?e.slice(0,-1):e,_=new RegExp(/\n\n$/),y=new RegExp(/^(close|data|event|id|):\s?(.*)/),v=e=>{let[t,n]=["",""];const r=y.exec(e);return r&&3===r.length&&([,t,n]=r),e.length>0&&!e.includes(":")&&(t=e),[t,n]},b=(e,t,n)=>{switch(t){case"event":e.name=n;break;case"data":e.data=`${e.data||""}${n}\n`;break;case"id":e.id=n}return e},S=e=>{let t={data:"",name:""},n="";return r=>{if(n+=r,_.test(n)){n=m(n,"\n");for(const r of n.split("\n")){if(""===r){t.data=m(t.data||"","\n"),e(t),t={data:"",name:""},n="";continue}if(":"===r[0])continue;const[s,i]=v(r);t=b(t,s,i)}}}};var x=n(55089);const C="undefined"!=typeof process&&process.release&&"node"===process.release.name,k=e=>"function"==typeof e?e():null,Z=(e,t,n)=>({code:t,error:n,stopped:e});class E{constructor(e){this.callback=e.callback,this.user=e.user,this.manager=e.manager,this.authenticationMethod=e.authenticationMethod,this.session={active:!0,datacenter:e.datacenter,seq:0,uuid:(0,x.Z)()},this.m3Client=i(e.m3Client)?e.m3Client:a(),this.initTimestamp=Date.now(),this.didFirstPoll=!1,e.returnHeaders&&(this.returnHeaders=!0),this.authenticateUser((e=>{if(e)return this.session.active=!1,void this.callback(e,null,this);this.maybeSendAck=((e,t)=>{let n=Date.now();return r=>(Date.now()-n>=t&&(n=Date.now(),e()),r)})(this.sendAck,3e4),this.retryPolling()}))}authenticateUser=e=>{if(!this.authenticationMethod||"sameorigin"===this.authenticationMethod)return void e();if("undefined"==typeof fetch||fetch.polyfill||C)return void e(Z(!0,"unsupported_browser"));const t=p("ACK",this.session.datacenter,this.authenticationMethod);fetch(`${t}?seq=-1`,{credentials:"include",mode:"no-cors"}).then((e=>e.ok?e:fetch(`${t}?seq=-1`,{credentials:"include"}))).then((t=>{const n=200===t.status?void 0:Z(!0,"authentication_failed");e(n)})).catch((t=>e(Z(!0,"authentication_failed",t))))};startPolling=e=>{const t=`${p("RECV",this.session.datacenter,this.authenticationMethod)}?seq=${this.session.seq}`,n=[...f(this.user),["cache-control","no-cache"],["x-uber-client-session",this.session.uuid],this.user.uuid?["x-auth-params-user-uuid",this.user.uuid]:null].filter(Boolean);this.session.stopPolling=((e,t)=>{const n=new XMLHttpRequest,r=c(t.onDisconnect),s=c(t.onConnect),i={lastResponse:Date.now(),xhr:n};let a=0,o=0;return n.onreadystatechange=()=>{if(n.readyState===n.LOADING||n.readyState===n.DONE){n.status<400&&s(null),i.lastResponse=Date.now();const e=n.responseText.substring(o);o=n.responseText.length,t.callback(e)}const e=n.readyState<a;if(a=Math.max(n.readyState,a),n.readyState===n.DONE||e){let s={connectionClosed:n.readyState===n.DONE,responseText:n.responseText,statusCode:n.status,timestamp:(new Date).toISOString(),userAborted:e};t.returnHeaders&&(s={...s,requestHeaders:n._headers,responseHeaders:n.responseHeaders}),r(null,s)}},n.onerror=e=>{n.abort(),r(new Error(e))},n.open("GET",e),n.withCredentials=!0,t.headers.map((e=>{let[t,r]=e;return n.setRequestHeader(t,r)})),n.send(),i.lastResponse=Date.now(),l(i,t.disconnectInterval),()=>n.abort()})(t,{callback:u(S(this.handleEvent),this.maybeSendAck),disconnectInterval:2e4,headers:n,onDisconnect:e,returnHeaders:this.returnHeaders,onConnect:()=>{this.manager&&this.manager.notifyConnection(this)}})};retryPolling=()=>{const e=Date.now();this.m3Client.increment("request",{method:"recv"}),this.didFirstPoll||(this.m3Client.timing("client-ready",Date.now()-this.initTimestamp),this.didFirstPoll=!0),this.startPolling(((t,n)=>{this.session.active?(t?this.callback(Z(!1,"client_error",t),null,this):this.callback(Z(!1,"client_disconnected",n),null,this),this.m3Client.timing("latency",Date.now()-e,{method:"recv"}),setTimeout(this.retryPolling,5e3)):this.callback(Z(!0,"session_inactive",t),null,this)}))};sendAck=()=>{const e=p("ACK",this.session.datacenter,this.authenticationMethod),t=Date.now();this.m3Client.increment("request",{method:"ack"}),((e,t,n)=>{const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState===r.DONE){if(r.status<200||r.status>=300){let e={message:r.responseText,status:r.status};return t.returnHeaders&&(e={...e,requestHeaders:r._headers,responseHeaders:r.responseHeaders}),void n(e)}n(null,o(r.responseText))}},r.open(t.method,e),r.timeout=t.timeout||3e4,r.withCredentials=!0,t.headers.map((e=>{let[t,n]=e;return r.setRequestHeader(t,n)})),r.send(t.body||null)})(`${e}?seq=${this.session.seq}`,{headers:[...f(this.user),["x-uber-client-session",this.session.uuid],this.user.uuid?["x-auth-params-user-uuid",this.user.uuid]:null].filter(Boolean),method:"GET",returnHeaders:this.returnHeaders},(e=>{e&&this.callback(Z(!1,"ack_failed",e),null,this),this.m3Client.timing("latency",Date.now()-t,{method:"ack"})}))};handleEvent=e=>{if((e=>!(e.name||e.data||e.seq))(e))return;if("close"===e.name)return void k(this.session.stopPolling);const{msg:t}=o(e.data);"rmn-msg-v1"===e.name&&Array.isArray(t)?t.map(this.handleMessage):this.callback(Z(!1,"unrecognised_message",e),null,this)};handleMessage=e=>{Number.isFinite(e.seq)&&e.seq>this.session.seq&&(this.session.seq=e.seq),this.callback(null,e,this)};stop=()=>{this.session.active=!1,k(this.session.stopPolling)}}var w=n(7858),O=n.n(w);const $=["phx2","dca1"];const D=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.user)throw new Error("RamenJS init error: `options.user` is required");if(!e.user.app)throw new Error("RamenJS init error: `options.user.app` is a required field");this.handlers={message:[],connect:[],disconnect:[],error:[]},this.clients=[],this.disconnectionTimeout=e.disconnectionTimeout||15e3,this.user=e.user;const t=e.dc||e.datacenter||$;return this.dcs=(Array.isArray(t)?t:[t]).reduce(((e,t)=>(e[t]={status:"disconnected",timeout:null},e)),{}),this.authenticationMethod=e.authenticationMethod||"sameorigin",this.m3Client=i(e.m3Client)?e.m3Client:a(),this.mockedClient=e.mockedClient||!1,this}on(e,t){return this.handlers.hasOwnProperty(e)&&(this.handlers[e].push(t),this.initializeClients()),this}off(e,t){if(!this.handlers.hasOwnProperty(e))return this;if(!t&&this.handlers[e].length)this.handlers[e]=[];else{const n=this.handlers[e].indexOf(t);-1!==n&&this.handlers[e].splice(n,1)}return this.hasSubscribers()||this.stopClients(),this}initializeClients(){this.clients.length||this.mockedClient||Object.keys(this.dcs).forEach((e=>{const t=new E({datacenter:e,user:this.user,authenticationMethod:this.authenticationMethod,m3Client:this.m3Client,callback:this.handleClientResponse.bind(this),manager:this});this.clients.push(t)}))}handleClientResponse(e,t,n){if(e){const t=n.session.datacenter;this.dcs[t]&&(this.dcs[t].lastError=e,this.dcs[t].timeout||"disconnected"===this.dcs[t].status||(this.dcs[t].timeout=setTimeout((()=>{this.dcs[t].status="disconnected",this.dcs[t].timeout=null,this.trigger("disconnect",{...this.getConnectionStatus(),error:this.dcs[t].lastError},n)}),this.disconnectionTimeout))),this.trigger("error",e,n)}else if(t){let e=t.msg;try{e=JSON.parse(`${e}`)}catch(e){this.trigger("error",`parsing error ${e}`,n)}this.trigger("message",{...t,msg:e},n)}}trigger(e,t,n){const r=n?{dc:O()(n,"session.datacenter")}:{};this.handlers[e].forEach((e=>{e(t,r)}))}stopClients(){}hasSubscribers(){for(let e of Object.keys(this.handlers))if(this.handlers[e].length)return!0;return!1}getConnectionStatus(){let e=!1,t=!1;return{details:Object.keys(this.dcs).reduce(((n,r)=>{const s=this.dcs[r].status;return"connected"===s?t=!0:e=!0,n[r]=s,n}),{}),status:t?e?"limited":"connected":"disconnected"}}notifyConnection(e){const t=e.session.datacenter,n=O()(this.dcs[t],"timeout");clearTimeout(n);let r="connected"!==O()(this.dcs[t],"status");this.dcs[t]={status:"connected",timeout:null,lastError:null},r&&this.trigger("connect",this.getConnectionStatus(),e)}};var H=n(91631),M=n(37394),T=n(34626),P=n(87444),A=n(63658),R=n(9580),z=n(58984),I=n(15070),B=n(47986),L=n(33535),q=n(15649),N=n(55811),F=n(71051),j=n(87696),U=n(92431),V=n(62149),G=n(94131),X=n(24757),Q=n(71041),K=n(47566),J=n(66525),W=n(17217),Y=n(72843);const ee=["pendingRating","ratingSubmitted","orderRating"];var te=n(95461);function ne(e,t){return e?"postmates":t?"orchid":"ubereats"}const re=()=>{const e=(0,U.Z)(),t=(0,q.Z)(),n=(0,L.ZP)(),s=(0,H.k6)(),i=(0,V.TH)(),a=(0,M.Z)(),{user:o}=(0,T.Z)(),c=o.data?.isLoggedIn;let l=(0,P.Z)("web_ramen");const u=(0,P.Z)("nsw_age_verification"),d=(0,z.I0)(),h=(0,I.v)((e=>{let{ramen:t}=e;return t})),p=(0,r.useRef)(0),g=(0,r.useRef)(null),f=(0,r.useRef)({}),m="postmates"===(0,N.Z)(),_=(0,te.Z)(),y=(0,j.kR)(e),v=function(){const e=(0,P.Z)("eater_message_interstitials"),t=(0,X.Z)(),n=(0,L.ZP)(),{search:s,pathname:i}=(0,V.TH)(),{getEaterMessageInterstitialSessionCapper:a}=(0,Q.Z)(),{isSavingsLanding:o,isSavingsLandingInterstitial:c}=(0,J.Z)(),l=o||c,u=(0,r.useCallback)((e=>Boolean((0,H.LX)(i,e))),[i]);return(0,r.useCallback)((r=>{if(!r?.messages?.length)return!1;const{surface:i,surfaceId:o,message:c}=r.messages[0]||{},d=t({surface:i,surfaceId:o,...c});n("eats:eater_message_ramen_log",{eaterMessage:{ramenMsg:JSON.stringify(r),surface:o||G.cx.UNKNOWN}});const h=String(Y.parse(s)[B.FSm.modalName]),p=ee.includes(h),g=Boolean(d),f=d?.payload,m="modalPayload"===f?.type&&f?.modalPayload.uuid||"",{hasPromotionBanner:_,hasExpandedModalState:y}=(0,K.X1)(d),v=!l&&(!_||y);switch(o){case G.cx.HOME_FEED_PUSH_BOTTOM_MODAL:return e&&!a(G.cx.HOME_FEED_PUSH_BOTTOM_MODAL,m)&&g&&v&&u(W.r.home_feed);case G.cx.VERTICAL_FEED_PUSH_BOTTOM_MODAL:return e&&!a(G.cx.VERTICAL_FEED_PUSH_BOTTOM_MODAL,m)&&g&&v&&u(W.r.vertical_feed);case G.cx.ORDER_TRACKING_PUSH_BOTTOM_MODAL:return e&&!a(G.cx.ORDER_TRACKING_PUSH_BOTTOM_MODAL,m)&&g&&!u(W.r.vertical_feed);case G.cx.ORDER_COMPLETE_PUSH_BOTTOM_MODAL:return e&&!a(G.cx.ORDER_COMPLETE_PUSH_BOTTOM_MODAL,m)&&!p&&g;default:return!1}}),[s,e,a,n,t,l,u])}(),b=(0,r.useContext)(F.k7),S=(0,r.useCallback)((e=>{b.set("chatMessageUuid",e)}),[b]),C=(0,r.useCallback)((e=>{switch(e.type){case"chat":return void("system"!==e.msg.messageType&&S(e.uuid));case"eater_message_service_screen_messages":if(v(e.msg)){const t=(e.msg.messages||[])[0].surfaceId||"";s.push((0,B.tLx)(i,t))}return;case"home_membership_modal":return n("eats:home_membership_modal_ramen_message_received"),void s.push((0,B.bAD)(i,e.uuid));case"push_web_eats_verification_result":return void(u&&s.push((0,B.fDg)(i,e.msg.flowStatus)));default:return}}),[S,v,s,i,n,u]);return(0,r.useEffect)((()=>{if(h.messageQueue.length>0&&p.current<h.messageQueue.length){for(let e=p.current;e<h.messageQueue.length;e++){const t=h.messageQueue[e]||"",n=h.messageMap[t];n&&C(n)}p.current=h.messageQueue.length}}),[C,h]),(0,r.useEffect)((()=>{l&&c&&!g.current&&(g.current=new D({m3Client:a,user:{app:"eats_web",device:"eats-web",deviceId:y||(0,x.Z)(),language:t,origin:"eats-web",source:"eats-web",version:"1.0.0",appVariant:ne(m,_)}}).on("message",(e=>{const t=(0,A.n)(e);return t&&!f.current[t.uuid]&&d((0,R.l)(t)),t&&(f.current[t.uuid]=!0),()=>{g.current&&g.current.off("message")}})))}),[d,c,l,t,a,m,_,y,n]),null}},192:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var r=n(43193),s=n(91931),i=n(52298),a=n(14966),o=n(33990);const c=e=>({body1:{fontSize:e.typography.ParagraphXSmall.fontSize,lineHeight:e.typography.ParagraphXSmall.lineHeight},body2:{fontSize:e.typography.ParagraphSmall.fontSize,lineHeight:e.typography.ParagraphSmall.lineHeight},body3:{fontSize:e.typography.ParagraphMedium.fontSize,lineHeight:e.typography.ParagraphMedium.lineHeight},title1:{fontSize:e.typography.ParagraphLarge.fontSize,lineHeight:e.typography.ParagraphLarge.lineHeight},title2:{fontSize:e.typography.HeadingXSmall.fontSize,lineHeight:e.typography.HeadingXSmall.lineHeight},title3:{fontSize:e.typography.HeadingSmall.fontSize,lineHeight:e.typography.HeadingSmall.lineHeight},title4:{fontSize:e.typography.HeadingMedium.fontSize,lineHeight:e.typography.HeadingMedium.lineHeight},title5:{fontSize:"44px",lineHeight:"52px"},title6:{fontSize:"48px",lineHeight:"56px"}}),l=(e,t,n)=>({...t?{fontFamily:"medium"===t?e.typography.LabelMedium.fontFamily:e.typography.ParagraphMedium.fontFamily}:null,...n?c(e)[n]:null}),u=(0,s.zo)("div",{display:"table"}),d=(0,s.zo)("img",{verticalAlign:"middle"}),h=(0,s.zo)("span",(e=>{let{$color:t,$fontSize:n,$fontStyle:r,$textDecoration:s,$theme:i}=e;return{...l(i,r,n),...t?{color:t in i.colors?i.colors[t]:t}:null,...s?{textDecoration:s}:null,verticalAlign:"middle"}})),p=(0,s.zo)("a",(e=>{let{$color:t,$fontSize:n,$fontStyle:r,$theme:s}=e;return{...(0,a.lE)({$theme:s}),...l(s,r,n),verticalAlign:"middle",...t?{color:t in s.colors?s.colors[t]:t}:{}}}));function g(e){return(0,o.tZ)(o.HY,{children:e.lines.map(((t,n)=>(0,o.BX)(r.Fragment,{children:[(0,o.tZ)(u,{children:t.children.map(((e,t)=>"img"===e.type?(0,o.tZ)(d,{width:e.width,height:e.height,src:e.url},t):"text"===e.type?(0,o.tZ)(h,{...e.$as?{$as:e.$as}:null,$color:e.color,$fontStyle:e.fontStyle,$fontSize:e.fontSize,$textDecoration:e.textDecoration,children:e.text},t):"anchor"===e.type?(0,o.tZ)(p,{href:e.href,$color:e.color,$fontStyle:e.fontStyle,$fontSize:e.fontSize,children:e.text},t):null))}),"paragraph"===t.breakStyle&&n!==e.lines.length-1?(0,o.tZ)(i.ZP,{$height:16}):null,"heading"===t.breakStyle?(0,o.tZ)(i.ZP,{$height:8}):null]},n)))})}},30442:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(15070),s=n(59956);const i=()=>(0,r.v)((e=>{let{features:t}=e;return t}))[s.h6.capital_one_promo]},17557:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(87444),s=n(5639),i=n(47667);const a=()=>{const e=(0,i.Z)(),t=(0,r.Z)("checkout_upsell_jarring_fix_enabled"),{isMobile:n}=(0,s.hU)();return e&&t&&n}},71041:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(36151),s=n(64282),i=n(92431),a=n(87696);const o="uev2.messaging-interstitial-session-capper";function c(){const e=(0,i.Z)(),t=(0,a.Yk)(e),n=(0,s._)(),c=(0,r.useCallback)((()=>n.get(o)||{}),[n]);return{getEaterMessageInterstitialSessionCapper:(0,r.useCallback)(((e,n)=>{const r=c()[e];return r?.sessionId===t&&(r?.campaigns||[]).includes(n)}),[c,t]),setEaterMessageInterstitialSessionCapper:(0,r.useCallback)(((e,r)=>{const s=c(),i=s[e],a=i?.sessionId===t&&i?.campaigns?i.campaigns:[];a.includes(r)||a.push(r),s[e]={sessionId:t||"",campaigns:a},n.set(o,s)}),[n,t,c])}}},19883:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(60849),s=n(78982);const i=()=>(0,r.ip)({...s.J.scheduled_order_editing,defaultValue:!1})},95333:(e,t,n)=>{"use strict";n.d(t,{v:()=>d});var r=n(74622),s=n(60849),i=n(62459),a=n(92431),o=n(87696),c=n(30946),l=n(34626),u=n(97546);const d=()=>{const{user:e}=(0,l.Z)(),t=e.data?.isLoggedIn,n=(0,a.Z)(),d=(0,o.yU)(n),h=(0,i.Z)("getComplianceAds"),p=(0,s.ip)({...u.G.eats_web_gdpr_consent_modal,defaultValue:!1}),g=(0,c.Y)(),f=!(0,o.q8)(n)&&!g&&p,m=t&&f&&!d,{data:_}=(0,r.useQuery)("getComplianceAds",(()=>h.request("getComplianceAds",null)),{enabled:m});return!!t&&(!!f&&(!d&&_?.value))}},21926:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(60849),s=n(78982);const i=()=>(0,r.ip)({...s.J.is_repeat_group_order_enabled,defaultValue:!1})},98462:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(60849),s=n(78982);const i=()=>(0,r.ip)({...s.J.buy_an_item_enabled,defaultValue:!1})},47885:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(60849),s=n(41063);const i=()=>{const e={...s.v.store_precheckout_bundling,defaultValue:!1},t={...s.v.eats_web_store_pcb_be_driven_limit_reached,defaultValue:!1};return{isStorePrecheckoutBundlingEnabled:(0,r.ip)(e),isBeDrivenLimitReachedDialogEnabled:(0,r.ip)(t)}}},37394:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(68739),s=n(49181);function i(){return(0,r.G2)(s.EK)}},69611:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(36151),s=n(15070),i=n(71051),a=n(27130),o=n(79857);function c(){const e=(0,o.Z)(),t=(0,s.v)((e=>{let{embeddedFeatures:t}=e;return t})),n=(0,r.useContext)(i.k7),c=(0,a.Z)("emitXlbHomeFeedEventV1");return(0,r.useCallback)((r=>{let{source:s}=r;if(!e)return;let i=!0;if(t.prefetch){n.set(`uev2.xlb_${s}_impression`,"true");const e=n.get("uev2.xlb_feed_loaded_impression"),t=n.get("uev2.xlb_user_triggered_impression");i=e&&t}i&&c()}),[e,t.prefetch,n,c])}},63658:(e,t,n)=>{"use strict";function r(e){if(!e||"object"!=typeof e)return null;const t=function(e){const{priority:t,seq:n,uuid:r}=e;if(!t||!n||!r)return null;return{priority:t,seq:n,uuid:r}}(e);if(!t)return null;switch(e.type){case"eater_menu_actions":return{type:"eater_menu_actions",...t,msg:e.msg||{}};case"chat":return{type:"chat",...t,msg:e.msg||{}};case"eater_message_service_screen_messages":return{type:"eater_message_service_screen_messages",...t,msg:e.msg||{}};case"home_membership_modal":return{type:"home_membership_modal",...t,msg:e.msg||{}};case"push_web_eats_verification_result":return{type:"push_web_eats_verification_result",...t,msg:e.msg||{}};default:return null}}n.d(t,{n:()=>r})}}]);